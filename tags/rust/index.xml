<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>rust on ud01</title><link>https://cyanide4dinner.github.io/tags/rust/</link><description>Recent content in rust on ud01</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Utkarsh Dwivedi</copyright><lastBuildDate>Tue, 21 Jun 2022 21:27:52 +0530</lastBuildDate><atom:link href="https://cyanide4dinner.github.io/tags/rust/index.xml" rel="self" type="application/rss+xml"/><item><title>Devlog 01: Rust development (Ravana)</title><link>https://cyanide4dinner.github.io/posts/devlog-01/</link><pubDate>Tue, 21 Jun 2022 21:27:52 +0530</pubDate><guid>https://cyanide4dinner.github.io/posts/devlog-01/</guid><description>Deserializing responses Continuing development of my Rust-based Reddit API wrapper, serde_json effortlessly deserialized response string to map-based tree structure which I use to fill up my custom Listing &amp;amp; Post structures.
Error types Also, refactoring made me rethink approach to errors. Firstly, if using enums (which I was) no value was added by declaring multiple error enums, if anything having multiple enums made returning errors a hassle as I had to conert between the error types.</description><content>&lt;h2 id="deserializing-responses">Deserializing responses&lt;/h2>
&lt;p>Continuing development of my &lt;a href="https://github.com/Cyanide4Dinner/ravana_reddit_api">Rust-based Reddit API wrapper&lt;/a>,
&lt;a href="https://docs.serde.rs/serde_json/">&lt;code>serde_json&lt;/code>&lt;/a> effortlessly deserialized response string to map-based tree structure which I use to fill up my custom &lt;code>Listing&lt;/code> &amp;amp; &lt;code>Post&lt;/code> structures.&lt;/p>
&lt;h2 id="error-types">Error types&lt;/h2>
&lt;p>Also, refactoring made me rethink approach to errors. Firstly, if using enums (which I was) no value was added by declaring multiple error enums, if anything having multiple enums made returning errors a hassle as I had to conert between the error types. There might be some benefit on categorizing errors into groups so that the user can have more information and flexibility on handling the errors, especially for a library. However, enum variants seemed enough for one level of grouping. I&amp;rsquo;m still not able to reason for a second level of grouping by having different enum types too for errors. Hence, I&amp;rsquo;ve finalised on keeping a single enum as error type for the entire library.&lt;/p>
&lt;p>For code quality and maintainability, the variants should not be abused which raises the question of when should we seperate out a error as a seperate enum variant?&lt;/p>
&lt;p>One way is to create a variant for all those errors concerned with one functionality. Such as a type for errors based on request processing or connection and another for errors that arose due to invalid response or failure during serializing and parsing.&lt;/p>
&lt;p>Another is to create different enum variants for different errors that could be &lt;em>handled&lt;/em> differently. For instance, a developer might want on timing out on a request, that an alert pops requesting user to check their internet connection and grouping it with other errors such as those arising for server errors seems more appropriate.&lt;/p>
&lt;h2 id="iterating-over-errors">Iterating over errors&lt;/h2>
&lt;p>A neat trick I came across while indulging in a problem I was facing tells us how to convert a &lt;code>Vec&amp;lt;Result&amp;lt;T, E&amp;gt;&lt;/code> to &lt;code>Result&amp;lt;Vec&amp;lt;T&amp;gt;, E&amp;gt;&lt;/code>. Credits to &lt;a href="https://stackoverflow.com/a/26370894/9897643">this answer&lt;/a>.&lt;/p>
&lt;p>This comes quite handy when using &lt;code>map&lt;/code> and the closure could throw errors. If we want the pure vector and throw error if &lt;code>map&lt;/code> throws error for any item, simply collect over &lt;code>Result&lt;/code> and &lt;code>from_iter&lt;/code> will do the rest for us.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-rust" data-lang="rust">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> posts: Vec&lt;span style="color:#f92672">&amp;lt;&lt;/span>Post&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#f92672">=&lt;/span> Result::&lt;span style="color:#f92672">&amp;lt;&lt;/span>Vec&lt;span style="color:#f92672">&amp;lt;&lt;/span>Post&lt;span style="color:#f92672">&amp;gt;&lt;/span>, Error&lt;span style="color:#f92672">&amp;gt;&lt;/span>::from_iter::&lt;span style="color:#f92672">&amp;lt;&lt;/span>Vec&lt;span style="color:#f92672">&amp;lt;&lt;/span>Result&lt;span style="color:#f92672">&amp;lt;&lt;/span>Post, Error&lt;span style="color:#f92672">&amp;gt;&amp;gt;&amp;gt;&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> values
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .into_iter()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .map(&lt;span style="color:#f92672">|&lt;/span>value&lt;span style="color:#f92672">|&lt;/span> -&amp;gt; Result&lt;span style="color:#f92672">&amp;lt;&lt;/span>Post, Error&lt;span style="color:#f92672">&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> value.convert_value_to_post() &lt;span style="color:#75715e">//Could throw error
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .collect())&lt;span style="color:#f92672">?&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></content></item></channel></rss>